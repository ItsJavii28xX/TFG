<mat-card class="members-select-card">
  <h3>Selecciona miembros</h3>

  <!-- 1) LISTADO SCROLLABLE DE CONTACTOS -->
  <mat-list class="scrollable-list">
    <mat-list-item
      *ngFor="let u of allUsers"
      class="flex-row"
      (click)="toggle(u)"
      [class.selected]="isSelected(u)"
    >
      <!-- AVATAR A LA IZQUIERDA -->
      <img
        matListAvatar
        [src]="u.imagen_perfil || 'avatar-placeholder.png'"
        alt="avatar"
        class="menu-avatar"
      />

      <!-- NOMBRE + APELLIDOS A LA DERECHA DEL AVATAR -->
      <span class="user-name">{{ u.nombre }}</span>

      <!-- ICONO “CHECK” SI ESTÁ SELECCIONADO -->
      <mat-icon matListIcon *ngIf="isSelected(u)">check</mat-icon>

      <!-- CHECKBOX “Admin” a la derecha -->
      <mat-checkbox
        *ngIf="isSelected(u)"
        class="admin-checkbox"
        [checked]="adminMap[u.id_usuario]"
        (change)="adminMap[u.id_usuario] = $event.checked"
        (click)="$event.stopPropagation()"
      >
        Admin
      </mat-checkbox>
    </mat-list-item>
  </mat-list>

  <div class="manual-email">
    <input
      matInput
      placeholder="Correo manual"
      [(ngModel)]="manualEmail"
      class="manual-input"
    />
    <!-- IMPORTANTE: agregar type="button" para que NO haga submit -->
    <button type="button" mat-stroked-button color="primary" (click)="addManual()">
      Añadir
    </button>
  </div>

  <!-- 3) BOTONES “Cancelar” y “Listo” -->
  <div class="edit-actions members-actions">
    <button mat-button color="warn" (click)="onCancel()">Cancelar</button>
    <button
      mat-flat-button
      color="primary"
      [disabled]="selected.length === 0"
      (click)="onDone()"
    >
      Listo
    </button>
  </div>
</mat-card>
