<app-header></app-header>

<div class="layout">
  <div class="sidebar-container">
    <app-sidebar [status]="collapsed ? 'closed' : 'open'"></app-sidebar>
    <button class="toggle-btn" mat-mini-fab (click)="toggleSidebar()">
      <mat-icon>{{ collapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
    </button>
  </div>

 <section class="main-content">
    <!-- Pase a Content el estado de deleteMode y selecciÃ³n -->
    <app-content
      [deleteMode]="deleteMode"
      [selectedIds]="selectedToDelete"
      (selectionChange)="onSelectionChange($event)">
    </app-content>

    <!-- Barra de acciones en modo borrado -->
    <div *ngIf="deleteMode" class="delete-toolbar">
      <button mat-button (click)="cancelDelete()">Cancelar</button>
      <button mat-raised-button color="warn"
              (click)="confirmDelete()"
              [disabled]="!selectedToDelete.size">
        Eliminar {{ selectedToDelete.size }}
      </button>
    </div>

    <!-- FAB y panel de opciones -->
    <button mat-fab class="fab" (click)="toggleOptions()">
      <mat-icon>group_add</mat-icon>
    </button>
    <app-group-options
      [open]="optionsOpen"
      (add)="openAddForm()"
      (delete)="openDeleteForm()"
      (close)="optionsOpen = false"
      (update)="openUpdateForm()">
    </app-group-options>

    <!-- Modal para crear grupo -->
    <div *ngIf="showAddForm" class="overlay" (click)="onAddCancel()">
      <div class="form-wrapper" (click)="$event.stopPropagation()">
        <app-group-form
          (cancel)="onAddCancel()"
          (created)="onGroupCreated()">
        </app-group-form>
      </div>
    </div>
  </section>
  
</div>

<app-footer></app-footer>
