<app-header></app-header>

<div class="layout">
  <div class="sidebar-container">
    <app-sidebar [status]="collapsed ? 'closed' : 'open'"></app-sidebar>
    <button class="toggle-btn" mat-mini-fab (click)="toggleSidebar()">
      <mat-icon>{{ collapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
    </button>
  </div>

  <section class="main-content">
    <!-- le paso deleteMode y updateMode -->
    <app-content
      [deleteMode]="deleteMode"
      [selectedIds]="selectedToDelete"
      (selectionChange)="onSelectionChange($event)"
      [updateMode]="updateMode">
    </app-content>

    <!-- toolbar de borrar -->
    <div *ngIf="deleteMode" class="action-toolbar delete-toolbar">
      <button mat-button (click)="cancelDelete()">Cancelar</button>
      <button
        mat-raised-button color="warn"
        (click)="confirmDelete()"
        [disabled]="!selectedToDelete.size">
        Eliminar {{ selectedToDelete.size }}
      </button>
    </div>

    <!-- toolbar de editar -->
    <div *ngIf="updateMode" class="action-toolbar update-toolbar">
      <button mat-button (click)="cancelUpdate()">Cancelar edici√≥n</button>
    </div>

    <!-- FAB y panel de opciones -->
    <button mat-fab class="fab" (click)="toggleOptions()">
      <mat-icon>group_add</mat-icon>
    </button>
    <app-group-options
      [open]="optionsOpen"
      (add)="openAddForm()"
      (delete)="openDeleteForm()"
      (update)="openUpdateForm()"
      (close)="optionsOpen=false">
    </app-group-options>

    <!-- modal Crear Grupo -->
    <div *ngIf="showAddForm" class="overlay" (click)="onAddCancel()">
      <div class="form-wrapper" (click)="$event.stopPropagation()">
        <app-group-form
          (cancel)="onAddCancel()"
          (created)="onGroupCreated()">
        </app-group-form>
      </div>
    </div>
  </section>
</div>

<app-footer></app-footer>
